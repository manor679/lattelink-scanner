<!DOCTYPE html>
<html>
<head>
  <title>LatteLink Check-In</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 40px; background: #f9f3eb; }
    input, button { margin: 10px; padding: 12px; font-size: 18px; width: 280px; border-radius: 6px; border: 1px solid #ccc; }
    button { background: #6d4c41; color: white; cursor: pointer; }
  </style>
</head>
<body>

  <h1>‚òï LatteLink Check-In</h1>
  <p>Enter your phone/email and the code from staff</p>

  <input type="text" id="userId" placeholder="Your phone or email"><br>
  <input type="text" id="pinCode" placeholder="Staff code"><br>
  <button onclick="checkIn()">Check In</button>

  <div id="message" style="margin-top: 20px; font-weight: bold;"></div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/YOUR_DEPLOYMENT_ID/exec"; // Replace this!

    async function checkIn() {
      const id = document.getElementById("userId").value.trim();
      const pin = document.getElementById("pinCode").value.trim();
      const msg = document.getElementById("message");

      if (!id || !pin) {
        msg.textContent = "Please enter both your ID and the code.";
        return;
      }

      msg.textContent = "Checking in...";

      try {
        const response = await fetch(scriptURL, {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: `id=${encodeURIComponent(id)}&pin=${encodeURIComponent(pin)}`
        });
        const data = await response.json();

        if (data.error) {
          msg.textContent = "‚ùå " + data.error;
        } else {
          const left = 10 - data.coffees;
          msg.textContent = `‚úÖ You now have ${data.coffees} coffee${data.coffees == 1 ? "" : "s"} ‚Äî ${left <= 0 ? "Enjoy your free coffee!" : left + " left until a free one!"}`;
        }
      } catch (err) {
        msg.textContent = "üö® Network error. Try again.";
      }
    }
  </script>

</body>
</html>
